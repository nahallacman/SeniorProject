<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>EthKitTCP: C:/Users/mainuser/Desktop/School/SeniorProject/EthKitTCP/TCPIP/CodeFromMicrochip/PingDemo.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EthKitTCP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_ping_demo_8c_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PingDemo.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_ping_demo_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*********************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *  ICMP Client Demo (Ping)</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *********************************************************************</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * FileName:        PingDemo.c</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * Dependencies:    TCP/IP stack</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Processor:       PIC18, PIC24F, PIC24H, dsPIC30F, dsPIC33F, PIC32</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Compiler:        Microchip C32 v1.05 or higher</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *                  Microchip C30 v3.12 or higher</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *                  Microchip C18 v3.30 or higher</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *                  HI-TECH PICC-18 PRO 9.63PL2 or higher</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * Company:         Microchip Technology, Inc.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * Software License Agreement</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * Copyright (C) 2002-2009 Microchip Technology Inc.  All rights</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * reserved.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * Microchip licenses to you the right to use, modify, copy, and</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * distribute:</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * (i)  the Software when embedded on a Microchip microcontroller or</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *      digital signal controller product (&quot;Device&quot;) which is</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *      integrated into Licensee&#39;s product; or</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * (ii) ONLY the Software driver source files ENC28J60.c, ENC28J60.h,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *      ENCX24J600.c and ENCX24J600.h ported to a non-Microchip device</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> *      used in conjunction with a Microchip ethernet controller for</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *      the sole purpose of interfacing with the ethernet controller.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * You should refer to the license agreement accompanying this</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * Software for additional information regarding your rights and</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * obligations.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * THE SOFTWARE AND DOCUMENTATION ARE PROVIDED &quot;AS IS&quot; WITHOUT</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * LIMITATION, ANY WARRANTY OF MERCHANTABILITY, FITNESS FOR A</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT SHALL</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * MICROCHIP BE LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * PROCUREMENT OF SUBSTITUTE GOODS, TECHNOLOGY OR SERVICES, ANY CLAIMS</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * BY THIRD PARTIES (INCLUDING BUT NOT LIMITED TO ANY DEFENSE</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * THEREOF), ANY CLAIMS FOR INDEMNITY OR CONTRIBUTION, OR OTHER</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * SIMILAR COSTS, WHETHER ASSERTED ON THE BASIS OF CONTRACT, TORT</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * (INCLUDING NEGLIGENCE), BREACH OF WARRANTY, OR OTHERWISE.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * Author               Date      Comment</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> *~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * E. Wood              4/26/08   Moved from MainDemo.c</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> ********************************************************************/</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#define __PINGDEMO_C</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_t_c_p_i_p_config_8h.html">TCPIPConfig.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#if defined(STACK_USE_ICMP_CLIENT)</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_t_c_p_i_p_8h.html">TCPIP Stack/TCPIP.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_main_demo_8h.html">MainDemo.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#define HOST_TO_PING    &quot;ww1.microchip.com&quot; // Address that ICMP client will ping.  If the DNS client module is not available in the stack, then this hostname is ignored and the local gateway IP address will be pinged instead.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/*****************************************************************************</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">  Function:</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    void PingDemo(void)</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">  Summary:</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">    Demonstrates use of the ICMP (Ping) client.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">  Description:</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">    This function implements a simple ICMP client.  The function is called</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">    periodically by the stack, and it checks if BUTTON0 has been pressed.  </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">    If the button is pressed, the function sends an ICMP Echo Request (Ping)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">    to a Microchip web server.  The round trip time is displayed on the UART</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">    when the response is received.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">    This function can be used as a model for applications requiring Ping </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">    capabilities to check if a host is reachable.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">  Precondition:</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">    TCP is initialized.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">  Parameters:</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">    None</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">  Returns:</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">    None</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">  ***************************************************************************/</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="_ping_demo_8c.html#af0f2ca8c1b78d7b8783d4c9579034b6b">   89</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_ping_demo_8c.html#af0f2ca8c1b78d7b8783d4c9579034b6b">PingDemo</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">static</span> <span class="keyword">enum</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        SM_HOME = 0,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        SM_GET_ICMP_RESPONSE</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    } PingState = SM_HOME;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">static</span> <a class="code" href="_generic_type_defs_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> Timer;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="_generic_type_defs_8h.html#a73a5fec9b19159a6647fbf000017b221">LONG</a> ret;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">switch</span>(PingState)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">case</span> SM_HOME:</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="comment">// Send a ping request out if the user pushes BUTTON0 (right-most one)</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="keywordflow">if</span>(BUTTON0_IO == 0u)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="comment">// Don&#39;t ping flood: wait at least 1 second between ping requests</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="_tick_8h.html#a035d1d3f8afdca7abedf588ee1b20af0">TickGet</a>() - Timer &gt; 1ul*TICK_SECOND)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    <span class="comment">// Obtain ownership of the ICMP module</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    <span class="keywordflow">if</span>(!<a class="code" href="_i_c_m_p_8h.html#a7d5aa7b678a681b3525914a3aff1ae32">ICMPBeginUsage</a>())</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    <span class="comment">// Update anti-ping flood timer</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    Timer = <a class="code" href="_tick_8h.html#a035d1d3f8afdca7abedf588ee1b20af0">TickGet</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    <span class="comment">// Send ICMP echo request</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">                    #if defined(STACK_USE_DNS)</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                        <a class="code" href="_i_c_m_p_8h.html#a257f3ca7849edfe1efc68e6e913c3795">ICMPSendPingToHostROM</a>((ROM <a class="code" href="_generic_type_defs_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>*)HOST_TO_PING);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">                    #else</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        <a class="code" href="_i_c_m_p_8h.html#a3cf37c8ea9aa447c6bb455575244327b">ICMPSendPing</a>(<a class="code" href="_stack_tsk_8h.html#a67540808395519081be1333c4e9aa1f8">AppConfig</a>.MyGateway.Val);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">                    #endif</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    PingState = SM_GET_ICMP_RESPONSE;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">case</span> SM_GET_ICMP_RESPONSE:</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment">// Get the status of the ICMP module</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            ret = <a class="code" href="_i_c_m_p_8h.html#aa24af113deb0e6821d33a3fd17f44f2a">ICMPGetReply</a>();                   </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span>(ret == -2)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <span class="comment">// Do nothing: still waiting for echo</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ret == -1)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="comment">// Request timed out</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">                #if defined(USE_LCD)</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                memcpypgm2ram((<span class="keywordtype">void</span>*)&amp;<a class="code" href="_common_2_l_c_d_blocking_8c.html#a7ff490d613be206c5024fe5a18ca0f9f">LCDText</a>[16], (ROM <span class="keywordtype">void</span> *)<span class="stringliteral">&quot;Ping timed out&quot;</span>, 15);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <a class="code" href="_common_2_l_c_d_blocking_8c.html#a5cd499a980bf803c2d4a78f12365cd35">LCDUpdate</a>();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                PingState = SM_HOME;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ret == -3)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="comment">// DNS address not resolvable</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">                #if defined(USE_LCD)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                memcpypgm2ram((<span class="keywordtype">void</span>*)&amp;<a class="code" href="_common_2_l_c_d_blocking_8c.html#a7ff490d613be206c5024fe5a18ca0f9f">LCDText</a>[16], (ROM <span class="keywordtype">void</span> *)<span class="stringliteral">&quot;Can&#39;t resolve IP&quot;</span>, 16);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="_common_2_l_c_d_blocking_8c.html#a5cd499a980bf803c2d4a78f12365cd35">LCDUpdate</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                PingState = SM_HOME;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="comment">// Echo received.  Time elapsed is stored in ret (Tick units).</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">                #if defined(USE_LCD)</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                memcpypgm2ram((<span class="keywordtype">void</span>*)&amp;<a class="code" href="_common_2_l_c_d_blocking_8c.html#a7ff490d613be206c5024fe5a18ca0f9f">LCDText</a>[16], (ROM <span class="keywordtype">void</span> *)<span class="stringliteral">&quot;Reply: &quot;</span>, 7);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <a class="code" href="_helpers_8h.html#a5d4b74bdb9f65383826e4de1e829d19c">uitoa</a>((<a class="code" href="_generic_type_defs_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a>)<a class="code" href="_tick_8h.html#a5389f2aec4db4283b4dd8eaee509c270">TickConvertToMilliseconds</a>((<a class="code" href="_generic_type_defs_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>)ret), &amp;<a class="code" href="_common_2_l_c_d_blocking_8c.html#a7ff490d613be206c5024fe5a18ca0f9f">LCDText</a>[16+7]);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                strcatpgm2ram((<span class="keywordtype">char</span>*)&amp;<a class="code" href="_common_2_l_c_d_blocking_8c.html#a7ff490d613be206c5024fe5a18ca0f9f">LCDText</a>[16+7], <span class="stringliteral">&quot;ms&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <a class="code" href="_common_2_l_c_d_blocking_8c.html#a5cd499a980bf803c2d4a78f12365cd35">LCDUpdate</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                PingState = SM_HOME;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="comment">// Finished with the ICMP module, release it so other apps can begin using it</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="_i_c_m_p_8h.html#aebd488cb63032755daeb1c3385381ec2">ICMPEndUsage</a>();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#endif  //#if defined(STACK_USE_ICMP_CLIENT)</span></div>
<div class="ttc" id="_generic_type_defs_8h_html_a4ae1dab0fb4b072a66584546209e7d58"><div class="ttname"><a href="_generic_type_defs_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a></div><div class="ttdeci">unsigned char BYTE</div><div class="ttdef"><b>Definition:</b> <a href="_generic_type_defs_8h_source.html#l00342">GenericTypeDefs.h:342</a></div></div>
<div class="ttc" id="_i_c_m_p_8h_html_a7d5aa7b678a681b3525914a3aff1ae32"><div class="ttname"><a href="_i_c_m_p_8h.html#a7d5aa7b678a681b3525914a3aff1ae32">ICMPBeginUsage</a></div><div class="ttdeci">BOOL ICMPBeginUsage(void)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m_p_8c_source.html#l00454">ICMP.c:454</a></div></div>
<div class="ttc" id="_stack_tsk_8h_html_a67540808395519081be1333c4e9aa1f8"><div class="ttname"><a href="_stack_tsk_8h.html#a67540808395519081be1333c4e9aa1f8">AppConfig</a></div><div class="ttdeci">APP_CONFIG AppConfig</div><div class="ttdef"><b>Definition:</b> <a href="_custom_h_t_t_p_app_8c_source.html#l01932">CustomHTTPApp.c:1932</a></div></div>
<div class="ttc" id="_i_c_m_p_8h_html_aebd488cb63032755daeb1c3385381ec2"><div class="ttname"><a href="_i_c_m_p_8h.html#aebd488cb63032755daeb1c3385381ec2">ICMPEndUsage</a></div><div class="ttdeci">void ICMPEndUsage(void)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m_p_8c_source.html#l00481">ICMP.c:481</a></div></div>
<div class="ttc" id="_common_2_l_c_d_blocking_8c_html_a5cd499a980bf803c2d4a78f12365cd35"><div class="ttname"><a href="_common_2_l_c_d_blocking_8c.html#a5cd499a980bf803c2d4a78f12365cd35">LCDUpdate</a></div><div class="ttdeci">void LCDUpdate(void)</div><div class="ttdef"><b>Definition:</b> <a href="_common_2_l_c_d_blocking_8c_source.html#l00318">LCDBlocking.c:318</a></div></div>
<div class="ttc" id="_tick_8h_html_a035d1d3f8afdca7abedf588ee1b20af0"><div class="ttname"><a href="_tick_8h.html#a035d1d3f8afdca7abedf588ee1b20af0">TickGet</a></div><div class="ttdeci">DWORD TickGet(void)</div><div class="ttdef"><b>Definition:</b> <a href="_tick_8c_source.html#l00270">Tick.c:270</a></div></div>
<div class="ttc" id="_t_c_p_i_p_8h_html"><div class="ttname"><a href="_t_c_p_i_p_8h.html">TCPIP.h</a></div></div>
<div class="ttc" id="_helpers_8h_html_a5d4b74bdb9f65383826e4de1e829d19c"><div class="ttname"><a href="_helpers_8h.html#a5d4b74bdb9f65383826e4de1e829d19c">uitoa</a></div><div class="ttdeci">void uitoa(WORD Value, BYTE *Buffer)</div><div class="ttdef"><b>Definition:</b> <a href="_helpers_8c_source.html#l00828">Helpers.c:828</a></div></div>
<div class="ttc" id="_ping_demo_8c_html_af0f2ca8c1b78d7b8783d4c9579034b6b"><div class="ttname"><a href="_ping_demo_8c.html#af0f2ca8c1b78d7b8783d4c9579034b6b">PingDemo</a></div><div class="ttdeci">void PingDemo(void)</div><div class="ttdef"><b>Definition:</b> <a href="_ping_demo_8c_source.html#l00089">PingDemo.c:89</a></div></div>
<div class="ttc" id="_tick_8h_html_a5389f2aec4db4283b4dd8eaee509c270"><div class="ttname"><a href="_tick_8h.html#a5389f2aec4db4283b4dd8eaee509c270">TickConvertToMilliseconds</a></div><div class="ttdeci">DWORD TickConvertToMilliseconds(DWORD dwTickValue)</div><div class="ttdef"><b>Definition:</b> <a href="_tick_8c_source.html#l00384">Tick.c:384</a></div></div>
<div class="ttc" id="_t_c_p_i_p_config_8h_html"><div class="ttname"><a href="_t_c_p_i_p_config_8h.html">TCPIPConfig.h</a></div></div>
<div class="ttc" id="_i_c_m_p_8h_html_a3cf37c8ea9aa447c6bb455575244327b"><div class="ttname"><a href="_i_c_m_p_8h.html#a3cf37c8ea9aa447c6bb455575244327b">ICMPSendPing</a></div><div class="ttdeci">void ICMPSendPing(DWORD dwRemoteIP)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m_p_8c_source.html#l00225">ICMP.c:225</a></div></div>
<div class="ttc" id="_common_2_l_c_d_blocking_8c_html_a7ff490d613be206c5024fe5a18ca0f9f"><div class="ttname"><a href="_common_2_l_c_d_blocking_8c.html#a7ff490d613be206c5024fe5a18ca0f9f">LCDText</a></div><div class="ttdeci">BYTE LCDText[16 *2+1]</div><div class="ttdef"><b>Definition:</b> <a href="_common_2_l_c_d_blocking_8c_source.html#l00068">LCDBlocking.c:68</a></div></div>
<div class="ttc" id="_generic_type_defs_8h_html_a2b0e863dadf920709ec53d9088ee7c91"><div class="ttname"><a href="_generic_type_defs_8h.html#a2b0e863dadf920709ec53d9088ee7c91">WORD</a></div><div class="ttdeci">unsigned short int WORD</div><div class="ttdef"><b>Definition:</b> <a href="_generic_type_defs_8h_source.html#l00343">GenericTypeDefs.h:343</a></div></div>
<div class="ttc" id="_i_c_m_p_8h_html_a257f3ca7849edfe1efc68e6e913c3795"><div class="ttname"><a href="_i_c_m_p_8h.html#a257f3ca7849edfe1efc68e6e913c3795">ICMPSendPingToHostROM</a></div><div class="ttdeci">void ICMPSendPingToHostROM(ROM BYTE *szRemoteHost)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m_p_8c_source.html#l00283">ICMP.c:283</a></div></div>
<div class="ttc" id="_main_demo_8h_html"><div class="ttname"><a href="_main_demo_8h.html">MainDemo.h</a></div></div>
<div class="ttc" id="_generic_type_defs_8h_html_ad342ac907eb044443153a22f964bf0af"><div class="ttname"><a href="_generic_type_defs_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a></div><div class="ttdeci">unsigned long DWORD</div><div class="ttdef"><b>Definition:</b> <a href="_generic_type_defs_8h_source.html#l00344">GenericTypeDefs.h:344</a></div></div>
<div class="ttc" id="_generic_type_defs_8h_html_a73a5fec9b19159a6647fbf000017b221"><div class="ttname"><a href="_generic_type_defs_8h.html#a73a5fec9b19159a6647fbf000017b221">LONG</a></div><div class="ttdeci">signed long LONG</div><div class="ttdef"><b>Definition:</b> <a href="_generic_type_defs_8h_source.html#l00350">GenericTypeDefs.h:350</a></div></div>
<div class="ttc" id="_i_c_m_p_8h_html_aa24af113deb0e6821d33a3fd17f44f2a"><div class="ttname"><a href="_i_c_m_p_8h.html#aa24af113deb0e6821d33a3fd17f44f2a">ICMPGetReply</a></div><div class="ttdeci">LONG ICMPGetReply(void)</div><div class="ttdef"><b>Definition:</b> <a href="_i_c_m_p_8c_source.html#l00318">ICMP.c:318</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bf0358f4e5621961cbeb32b415922792.html">School</a></li><li class="navelem"><a class="el" href="dir_a56df452fd7dbcffd543f2c29997c5b0.html">SeniorProject</a></li><li class="navelem"><a class="el" href="dir_cb3d5849c826c1a52ebe828f18b7b7c3.html">EthKitTCP</a></li><li class="navelem"><a class="el" href="dir_85d0404e6ddcb97f271635c649e4cbcf.html">TCPIP</a></li><li class="navelem"><a class="el" href="dir_a3f490b2f4555a8f4f955248a68e059a.html">CodeFromMicrochip</a></li><li class="navelem"><a class="el" href="_ping_demo_8c.html">PingDemo.c</a></li>
    <li class="footer">Generated on Thu May 7 2015 20:33:41 for EthKitTCP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
