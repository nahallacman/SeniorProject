<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>EthKitTCP: C:/Users/mainuser/Desktop/School/SeniorProject/EthKitTCP/Microchip/mTouchCap/PIC12F PIC16F Library/mTouch.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EthKitTCP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('m_touch_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mTouch.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements the post-acquisition filtering and decoding of the mTouch sensors.  
<a href="#details">More...</a></p>

<p><a href="m_touch_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab73968cbb19d4ae25a65698c15906b65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#ab73968cbb19d4ae25a65698c15906b65">mTouch_Init</a> (void)</td></tr>
<tr class="memdesc:ab73968cbb19d4ae25a65698c15906b65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main initialization routine for all mTouch framework modules including the built-in communication module, if enabled.  <a href="#ab73968cbb19d4ae25a65698c15906b65">More...</a><br /></td></tr>
<tr class="separator:ab73968cbb19d4ae25a65698c15906b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8955adf440115510aace00d81444e268"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___decoding.html#ga8955adf440115510aace00d81444e268">mTouch_Decode</a> (void)</td></tr>
<tr class="memdesc:ga8955adf440115510aace00d81444e268"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the state of each active-mode sensor using the latest acquisition value.  <a href="group___decoding.html#ga8955adf440115510aace00d81444e268">More...</a><br /></td></tr>
<tr class="separator:ga8955adf440115510aace00d81444e268"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad860d35191988afa8f9d02bcb946c08b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___decoding.html#gad860d35191988afa8f9d02bcb946c08b">mTouch_UpdateBaseline</a> (void)</td></tr>
<tr class="memdesc:gad860d35191988afa8f9d02bcb946c08b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the baseline for the given sensor with the given value.  <a href="group___decoding.html#gad860d35191988afa8f9d02bcb946c08b">More...</a><br /></td></tr>
<tr class="separator:gad860d35191988afa8f9d02bcb946c08b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad155881d69a8795e0c91a6eede8c0308"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#ad155881d69a8795e0c91a6eede8c0308">mTouch_ChangeState</a> (void)</td></tr>
<tr class="separator:ad155881d69a8795e0c91a6eede8c0308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a375aad16aafd424786ba67e79cc454d3"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a375aad16aafd424786ba67e79cc454d3">mTouch_ButtonStateMachine</a> (void)</td></tr>
<tr class="separator:a375aad16aafd424786ba67e79cc454d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8cfeefacb22ca490c1adbedd6fefcc1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#ac8cfeefacb22ca490c1adbedd6fefcc1">mTouch_FindMostPressed</a> (uint8_t)</td></tr>
<tr class="separator:ac8cfeefacb22ca490c1adbedd6fefcc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdcb5b33e2c73a81f71714ad360f1f50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#afdcb5b33e2c73a81f71714ad360f1f50">mTouch_UpdateMatrixOutput</a> (void)</td></tr>
<tr class="separator:afdcb5b33e2c73a81f71714ad360f1f50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e75a069b800f4deceefc6974a2b6e90"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a4e75a069b800f4deceefc6974a2b6e90">mTouch_ErrorDetect</a> (void)</td></tr>
<tr class="separator:a4e75a069b800f4deceefc6974a2b6e90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0e2a8ea4196b78b7aa765058fd758cd1"><td class="memItemLeft" align="right" valign="top">uint8_t(*const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a0e2a8ea4196b78b7aa765058fd758cd1">mTouch_StateMachine</a> [MTOUCH_NUMBER_SENSORS])(void)</td></tr>
<tr class="separator:a0e2a8ea4196b78b7aa765058fd758cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Global Sensor Variables</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>These variables store information about the current state of the sensors. They should only ever be updated by the mTouch framework, but may be read globally so that special actions can be taken based on the sensors' status. Refer to the mTouch.h file for more information about these variables. </p>
</div></td></tr>
<tr class="memitem:ab678fb469a6bdd3d0b75cc4b48adf504"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structm_touch___state.html">mTouch_State</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#ab678fb469a6bdd3d0b75cc4b48adf504">mTouch_state</a></td></tr>
<tr class="memdesc:ab678fb469a6bdd3d0b75cc4b48adf504"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tracks the state of the mTouch algorithm.  <a href="#ab678fb469a6bdd3d0b75cc4b48adf504">More...</a><br /></td></tr>
<tr class="separator:ab678fb469a6bdd3d0b75cc4b48adf504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affc22e96882bd0d8b258dd2241fe3fd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structm_touch___state_variables.html">mTouch_StateVariables</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#affc22e96882bd0d8b258dd2241fe3fd9">mTouch_stateVars</a></td></tr>
<tr class="memdesc:affc22e96882bd0d8b258dd2241fe3fd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores all state-temporary variables to be reinitialized each mode change.  <a href="#affc22e96882bd0d8b258dd2241fe3fd9">More...</a><br /></td></tr>
<tr class="separator:affc22e96882bd0d8b258dd2241fe3fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64be528d090489e1cc2bd740d55501ac"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a64be528d090489e1cc2bd740d55501ac">mTouch_average</a> [MTOUCH_NUMBER_SENSORS]</td></tr>
<tr class="memdesc:a64be528d090489e1cc2bd740d55501ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to track the unpressed value of each sensor.  <a href="#a64be528d090489e1cc2bd740d55501ac">More...</a><br /></td></tr>
<tr class="separator:a64be528d090489e1cc2bd740d55501ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab288c49098e419b3232336a4245b757d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#ab288c49098e419b3232336a4245b757d">mTouch_stateMask</a></td></tr>
<tr class="memdesc:ab288c49098e419b3232336a4245b757d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the state of each sensor in a bit mask for output by mComm when there are 16 or fewer sensors.  <a href="#ab288c49098e419b3232336a4245b757d">More...</a><br /></td></tr>
<tr class="separator:ab288c49098e419b3232336a4245b757d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a702d784953ba5bda08d044ce70491eab"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a702d784953ba5bda08d044ce70491eab">mTouch_deltas</a> [MTOUCH_NUMBER_SENSORS]</td></tr>
<tr class="memdesc:a702d784953ba5bda08d044ce70491eab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the latest delta value for each sensor. Only needed for functions that must compare sensors' relative shift amounts with each other.  <a href="#a702d784953ba5bda08d044ce70491eab">More...</a><br /></td></tr>
<tr class="separator:a702d784953ba5bda08d044ce70491eab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a827719a95ea3e7c38efa02c8e1188015"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a827719a95ea3e7c38efa02c8e1188015">mTouch_toggle</a></td></tr>
<tr class="memdesc:a827719a95ea3e7c38efa02c8e1188015"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggle state register when there are 16 or fewer sensors.  <a href="#a827719a95ea3e7c38efa02c8e1188015">More...</a><br /></td></tr>
<tr class="separator:a827719a95ea3e7c38efa02c8e1188015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87da226c0ba1ce6c8a452ead526b366d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a87da226c0ba1ce6c8a452ead526b366d">mTouch_matrix</a></td></tr>
<tr class="memdesc:a87da226c0ba1ce6c8a452ead526b366d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the current matrix output value for access by main application.  <a href="#a87da226c0ba1ce6c8a452ead526b366d">More...</a><br /></td></tr>
<tr class="separator:a87da226c0ba1ce6c8a452ead526b366d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c093cdeafc06345997ee5d8fa518d9f"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a7c093cdeafc06345997ee5d8fa518d9f">mTouch_matrix_latch</a></td></tr>
<tr class="memdesc:a7c093cdeafc06345997ee5d8fa518d9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the last matrix value for comparison with the new one.  <a href="#a7c093cdeafc06345997ee5d8fa518d9f">More...</a><br /></td></tr>
<tr class="separator:a7c093cdeafc06345997ee5d8fa518d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f396a12de88542d2461383d4bcc506"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structm_touch___most_pressed_data.html">mTouch_MostPressedData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#ad0f396a12de88542d2461383d4bcc506">mTouch_mostPressed</a></td></tr>
<tr class="separator:ad0f396a12de88542d2461383d4bcc506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2398619b264fd3f03386d89de32da07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structm_touch___most_pressed_data.html">mTouch_MostPressedData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#af2398619b264fd3f03386d89de32da07">mTouch_mostPressedData</a> [3]</td></tr>
<tr class="separator:af2398619b264fd3f03386d89de32da07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d6c0fb3a30070bee2ecccbfb65da43a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structm_touch___most_pressed_index.html">mTouch_MostPressedIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a5d6c0fb3a30070bee2ecccbfb65da43a">mTouch_mostPressedIndex</a> [3]</td></tr>
<tr class="separator:a5d6c0fb3a30070bee2ecccbfb65da43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Constant Threshold Arrays</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>These arrays are stored in program memory at compile time, so they do not require RAM. The downside to this implementation is that their values cannot be updated at runtime. If this is something your application requires, further editing will be needed. </p>
</div></td></tr>
<tr class="memitem:ab29410255e81d186a19b48c01053fc96"><td class="memItemLeft" align="right" valign="top">const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#ab29410255e81d186a19b48c01053fc96">mTouch_pressThreshold</a> [MTOUCH_NUMBER_SENSORS] = PRESS_THRESHOLD_INIT</td></tr>
<tr class="memdesc:ab29410255e81d186a19b48c01053fc96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant array containing the press threshold for each sensor.  <a href="#ab29410255e81d186a19b48c01053fc96">More...</a><br /></td></tr>
<tr class="separator:ab29410255e81d186a19b48c01053fc96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8684610eda16ac0df01d05ec5d7c362c"><td class="memItemLeft" align="right" valign="top">const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="m_touch_8c.html#a8684610eda16ac0df01d05ec5d7c362c">mTouch_releaseThreshold</a> [MTOUCH_NUMBER_SENSORS] = RELEASE_THRESHOLD_INIT</td></tr>
<tr class="memdesc:a8684610eda16ac0df01d05ec5d7c362c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant array containing the release threshold for each sensor.  <a href="#a8684610eda16ac0df01d05ec5d7c362c">More...</a><br /></td></tr>
<tr class="separator:a8684610eda16ac0df01d05ec5d7c362c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the post-acquisition filtering and decoding of the mTouch sensors. </p>

<p>Definition in file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a375aad16aafd424786ba67e79cc454d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t mTouch_ButtonStateMachine </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h1><a class="anchor" id="InitState"></a>
Initialization State</h1>
<p>The default state of all sensors on power up. Once sensors leave this state, they do not return. Initialization begins by decrementing the timer variable for the sensor. If #timer has not yet reached 0, the areInitialized and allReleased flags are cleared to prevent any advanced decoding logic, such as sliders and wheels, or communications from occuring. Once #timer reaches 0, the sensor transitions to the <a class="el" href="m_touch_cap_2_p_i_c12_f_01_p_i_c16_f_01_library_2m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2a9171b63f68c2e5ed308f9700e824cbbe" title="Sensor is currently released. ">MTOUCH_RELEASED</a> state, the debounce counter is reset to the value needed to enter the pressed state, and the baseline is updated to equal to the current sensor value.</p>
<h1><a class="anchor" id="ReleaseState"></a>
Released State</h1>
<p>This state can be entered from either the <a class="el" href="m_touch_cap_2_p_i_c12_f_01_p_i_c16_f_01_library_2m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2a8ac4e988fd74c22ff6e99ee854cc848f" title="Sensor is still initializing. ">MTOUCH_INITIALIZING</a> or <a class="el" href="m_touch_cap_2_p_i_c12_f_01_p_i_c16_f_01_library_2m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2aed5b3f2b7065991010f45eb04759ef01" title="Sensor is currently pressed. ">MTOUCH_PRESSED</a> state. The only way to leave this state is by creating enough consecutive positive shifts of the reading above the baseline to overflow the #debounce variable for the sensor. Once this is done, the sensor will enter the pressed state.<br />
 The code for this section begins by checking to see if the latest reading is greater than the baseline by at least the press threshold. If it is, the debounce variable is decremented. Once the debounce value has been reached 0, the sensor will change to the <a class="el" href="m_touch_cap_2_p_i_c12_f_01_p_i_c16_f_01_library_2m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2aed5b3f2b7065991010f45eb04759ef01" title="Sensor is currently pressed. ">MTOUCH_PRESSED</a> state, reset the debounce counter, initialize the press timer (if enabled), toggle the toggle bit, and clear the 'allReleased' flag.<br />
 If the threshold has not been crossed, the debounce counter is reset to the initial press debounce value and the baseline is updated.</p>
<dl class="section note"><dt>Note</dt><dd>This is the only state and condition where the baseline is able to be updated, and we only use the latest reading to update the baseline once we know it's not crossing any thresholds.</dd></dl>
<h1><a class="anchor" id="PressState"></a>
Pressed State</h1>
<p>A sensor can only enter this state from the <a class="el" href="m_touch_cap_2_p_i_c12_f_01_p_i_c16_f_01_library_2m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2a9171b63f68c2e5ed308f9700e824cbbe" title="Sensor is currently released. ">MTOUCH_RELEASED</a> state, but there are two ways to leave: First, by being in the state for too long and allowing the press timer to run out. Second, by having a the delta value smaller than the release threshold on enough consecutive scans to cause the debounce counter to reach 0.</p>
<p>The code for this section begins by decrementing and checking the #timer variable to see if it has reached 0. If so, the sensor transfers to the <a class="el" href="m_touch_cap_2_p_i_c12_f_01_p_i_c16_f_01_library_2m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2a9171b63f68c2e5ed308f9700e824cbbe" title="Sensor is currently released. ">MTOUCH_RELEASED</a> state, the debounce counter is reset and the baseline is re-initialized to the sensor's current reading. The baseline is reset to allow for a quick recovery if some environmental condition caused the sensor to become stuck. See the #NEGATIVE_CAPACITANCE configuration option for the different behaviors that can be implemented to quickly allow the baseline to re-settle to the unpressed value.</p>
<p>If the timer has not yet reached 0, the reading is checked against the release threshold. If the difference between the sensor's reading and the baseline (delta) is less than the release threshold, the debounce variable is decremented in the same manner as the press timer. When it reaches 0, the sensor enters the <a class="el" href="m_touch_cap_2_p_i_c12_f_01_p_i_c16_f_01_library_2m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2a9171b63f68c2e5ed308f9700e824cbbe" title="Sensor is currently released. ">MTOUCH_RELEASED</a> state and the debounce counter is set to debounce value required to enter the pressed state. If it has not crossed the threshold (meaning: the delta value is still large enough to register as a press), the debounce counter is reset to the release debounce value.</p>
<dl class="section note"><dt>Note</dt><dd>The baseline is never updated while the sensor is pressed so the system can remember where the unpressed value should end up. Because of this, the baseline can be better thought of as a released-state average.</dd></dl>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00579">579</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="m_touch_8c_a375aad16aafd424786ba67e79cc454d3_icgraph.png" border="0" usemap="#m_touch_8c_a375aad16aafd424786ba67e79cc454d3_icgraph" alt=""/></div>
<!-- MAP 0 -->
</div>
</p>

</div>
</div>
<a class="anchor" id="ad155881d69a8795e0c91a6eede8c0308"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mTouch_ChangeState </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4e75a069b800f4deceefc6974a2b6e90"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mTouch_ErrorDetect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l01106">1106</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac8cfeefacb22ca490c1adbedd6fefcc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mTouch_FindMostPressed </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00926">926</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="m_touch_8c_ac8cfeefacb22ca490c1adbedd6fefcc1_icgraph.png" border="0" usemap="#m_touch_8c_ac8cfeefacb22ca490c1adbedd6fefcc1_icgraph" alt=""/></div>
<!-- MAP 1 -->
</div>
</p>

</div>
</div>
<a class="anchor" id="ab73968cbb19d4ae25a65698c15906b65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mTouch_Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main initialization routine for all mTouch framework modules including the built-in communication module, if enabled. </p>
<h1><a class="anchor" id="InitImp"></a>
Framework Initialization Notes</h1>
<ol type="1">
<li>Loop through all enabled, active sensors and initialize their variables.</li>
<li>Loop through all enabled sliders and initialize the slider's output value.</li>
<li>Initialize mode variables and flags</li>
<li>Initialize non-array system variables</li>
<li>Initialize the DACOUT pin when it is used as a guard ring.</li>
<li>Initialize the ADC module for mTouch operation.</li>
<li>Initialization complete - enable active-mode mTouch scanning.</li>
</ol>
<p><br />
<br />
 </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00258">258</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="m_touch_8c_ab73968cbb19d4ae25a65698c15906b65_cgraph.png" border="0" usemap="#m_touch_8c_ab73968cbb19d4ae25a65698c15906b65_cgraph" alt=""/></div>
<!-- MAP 2 -->
</div>
</p>

</div>
</div>
<a class="anchor" id="afdcb5b33e2c73a81f71714ad360f1f50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mTouch_UpdateMatrixOutput </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00974">974</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="m_touch_8c_afdcb5b33e2c73a81f71714ad360f1f50_icgraph.png" border="0" usemap="#m_touch_8c_afdcb5b33e2c73a81f71714ad360f1f50_icgraph" alt=""/></div>
<!-- MAP 3 -->
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a64be528d090489e1cc2bd740d55501ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t mTouch_average[MTOUCH_NUMBER_SENSORS]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array to track the unpressed value of each sensor. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00086">86</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="a702d784953ba5bda08d044ce70491eab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t mTouch_deltas[MTOUCH_NUMBER_SENSORS]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores the latest delta value for each sensor. Only needed for functions that must compare sensors' relative shift amounts with each other. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00101">101</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="a87da226c0ba1ce6c8a452ead526b366d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t mTouch_matrix</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores the current matrix output value for access by main application. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00124">124</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7c093cdeafc06345997ee5d8fa518d9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t mTouch_matrix_latch</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores the last matrix value for comparison with the new one. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00125">125</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad0f396a12de88542d2461383d4bcc506"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structm_touch___most_pressed_data.html">mTouch_MostPressedData</a> * mTouch_mostPressed</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00126">126</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="af2398619b264fd3f03386d89de32da07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structm_touch___most_pressed_data.html">mTouch_MostPressedData</a> mTouch_mostPressedData</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00127">127</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5d6c0fb3a30070bee2ecccbfb65da43a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structm_touch___most_pressed_index.html">mTouch_MostPressedIndex</a> mTouch_mostPressedIndex</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=    {   </div>
<div class="line">                                                                            { MTOUCH_SENSOR_START,          MTOUCH_SENSOR_END        },</div>
<div class="line">                                                                            { MTOUCH_MATRIX_ROW_START,      MTOUCH_MATRIX_ROW_END    },</div>
<div class="line">                                                                            { MTOUCH_MATRIX_COLUMN_START,   MTOUCH_MATRIX_COLUMN_END }</div>
<div class="line">                                                                        }</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00128">128</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab29410255e81d186a19b48c01053fc96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint16_t mTouch_pressThreshold[MTOUCH_NUMBER_SENSORS] = PRESS_THRESHOLD_INIT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant array containing the press threshold for each sensor. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00184">184</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8684610eda16ac0df01d05ec5d7c362c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint16_t mTouch_releaseThreshold[MTOUCH_NUMBER_SENSORS] = RELEASE_THRESHOLD_INIT</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant array containing the release threshold for each sensor. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00185">185</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab678fb469a6bdd3d0b75cc4b48adf504"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structm_touch___state.html">mTouch_State</a> mTouch_state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tracks the state of the mTouch algorithm. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00084">84</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0e2a8ea4196b78b7aa765058fd758cd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t(*const mTouch_StateMachine[MTOUCH_NUMBER_SENSORS])(void)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00212">212</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab288c49098e419b3232336a4245b757d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t mTouch_stateMask</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores the state of each sensor in a bit mask for output by mComm when there are 16 or fewer sensors. </p>
<p>Stores the state of each sensor in a bit mask for output by mComm when there are 8 or fewer sensors.</p>
<p>Stores the state of each sensor in a bit mask for output by mComm when there are 32 or fewer sensors.</p>
<p>Stores the state of each sensor in a bit mask for output by mComm when there are 24 or fewer sensors. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00090">90</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="affc22e96882bd0d8b258dd2241fe3fd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structm_touch___state_variables.html">mTouch_StateVariables</a> mTouch_stateVars</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores all state-temporary variables to be reinitialized each mode change. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00085">85</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
<a class="anchor" id="a827719a95ea3e7c38efa02c8e1188015"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t mTouch_toggle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Toggle state register when there are 16 or fewer sensors. </p>
<p>Toggle state register when there are 8 or fewer sensors.</p>
<p>Toggle state register when there are 25 or more sensors.</p>
<p>Toggle state register when there are 24 or fewer sensors. </p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00106">106</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bf0358f4e5621961cbeb32b415922792.html">School</a></li><li class="navelem"><a class="el" href="dir_a56df452fd7dbcffd543f2c29997c5b0.html">SeniorProject</a></li><li class="navelem"><a class="el" href="dir_cb3d5849c826c1a52ebe828f18b7b7c3.html">EthKitTCP</a></li><li class="navelem"><a class="el" href="dir_75a0e0ee32de9d5f6d78f757d89d8692.html">Microchip</a></li><li class="navelem"><a class="el" href="dir_3a047e27b5f4bcb1817acd41632ae1cc.html">mTouchCap</a></li><li class="navelem"><a class="el" href="dir_1e142f69c0d1c62a2fe3d3319112ca90.html">PIC12F PIC16F Library</a></li><li class="navelem"><a class="el" href="m_touch_8c.html">mTouch.c</a></li>
    <li class="footer">Generated on Thu May 7 2015 20:33:52 for EthKitTCP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
